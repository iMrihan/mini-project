<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Product Page</title>
    <style>
      #container {
        display: flex;
        gap: 15px;
      }
      #btn {
        padding: 10px 30px;
        background-color: green;
        border-radius: 5px;
      }
    </style>
  </head>
  <body>
    <h1>Product Page</h1>
    <label>Sort by Price</label>
    <select id="sortProductPrice" onchange="sortProductPrice()">
      <option value="">---</option>
      <option value="low">Low to High</option>
      <option value="high">High to Low</option>
    </select>

    <label>Sort by Name</label>
    <select id="nameSort" onchange="nameSort()">
      <option value="">---</option>
      <option value="asc">Ascending</option>
      <option value="des">Descending</option>
    </select>
    <label>Filter by category</label>
    <select id="categorySort" onchange="categorySort()">
      <option value="">---</option>
      <option value="adidas">adidas</option>
      <option value="puma">puma</option>
      <option value="nike">nike</option>
    </select>
    <h2>Total Products = <span></span></h2>

    <div id="container"></div>
    <br />
    <button id="btn">Go to cart page</button>
  </body>
</html>
<script>
  var product = JSON.parse(localStorage.getItem("productDatabase")) || [];
  displayItem(product);

  var shoppingArr = JSON.parse(localStorage.getItem("productAdded")) || [];
  document.querySelector("span").textContent = product.length;

  function categorySort() {
    category = document.getElementById("categorySort").value;
    var filterList = product.filter(function(elem){
      return elem.name == category;
    })
    console.log(filterList);
    displayItem(filterList);
  }

  function sortProductPrice() {
    var price = document.querySelector("#sortProductPrice").value;

    if (price == "low") {
      product.sort(function (a, b) {
        return Number(a.price) - Number(b.price);
      });
    }

    if (price == "high") {
      product.sort(function (a, b) {
        return Number(b.price) - Number(a.price);
      });
    }
    displayItem(product);
  }
  function nameSort() {
    var name = document.querySelector("#nameSort").value;

    if (name == "asc") {
      product.sort(function (a, b) {
        if (a.name > b.name) return 1;
        else if (a.name < b.name) return -1;
        else return 0;
      });
    }

    if (name == "des") {
      product.sort(function (a, b) {
        if (a.name > b.name) return -1;
        else if (a.name < b.name) return 1;
        else return 0;
      });
    }
    displayItem(product);
  }
  function displayItem(product) {
    document.querySelector("#container").textContent = "";

    product.map(function (elem) {
      var div = document.createElement("div");
      var image = document.createElement("img");
      image.setAttribute("src", elem.image_url);
      var h3 = document.createElement("h3");
      h3.textContent = elem.name;
      var price = document.createElement("p");
      price.textContent = elem.price;

      var btn = document.createElement("button");
      btn.textContent = "add to cart";
      btn.addEventListener("click", function () {
        addToCart(elem);
      });

      div.append(image, h3, price, btn);
      document.querySelector("#container").append(div);
    });
  }
  function addToCart(elem) {
    shoppingArr.push(elem);

    localStorage.setItem("productAdded", JSON.stringify(shoppingArr));
  }
  document.querySelector("#btn").addEventListener("click", function () {
    window.location.href = "cart.html";
  });
</script>
